#!/bin/bash

source ./bin/colours

CURRENT_PATH="${PWD}"
STATUS=0

function _prune {

    echo -e "${BACK_RED_COLOR}"
    echo "                                                                                        "
    echo " [WANING] PRUNE IS A SPECIAL AND DELICATE RESOURCE FORM DOCKERIZED                      "
    echo "                                                                                        "
    echo -e "${COLOR_CLOSE}"

    echo "[INFO] Are you sure that apply prune on docker ?"
    echo "Please type yes or no and Press [Enter]: "
    read  OP

    if [[ $OP == "yes" ]]; then
        docker system prune --force
        echo "Prune is done"
    else
        echo "Skipping prune..."
    fi
}

if [[ -e "${CURRENT_PATH}/docker-compose.yml" ]]; then
    cd "${CURRENT_PATH}/"
    STATUS=1
    _prune
fi

if [[ -e "${CURRENT_PATH}/web/docker-compose.yml" && "${STATUS}" == 0 ]]; then
    cd "${CURRENT_PATH}/web/"
    STATUS=1
    _prune
fi

if [[ ${STATUS} == 0 ]]; then
    echo "Missing docker-compose.yml"
    exit
fi

exit
